<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>RV Park Mock</title>
  <link rel="stylesheet" href="./styles.css" />
  <script>
    // JS有効時のみ、CTAなどを段階表示（非JS時は常時表示）
    document.documentElement.classList.add("js");
  </script>
</head>
<body>
  <main class="page">
    <!-- HERO: 夕暮れの余韻（多層＋遅れて追従） -->
    <section class="hero" aria-label="北浦RVパーク HERO">
      <div class="hero__layers" aria-hidden="true">
        <div class="hero__bg"></div>
        <div class="hero__haze"></div>
        <div class="hero__glow"></div>
        <div class="hero__particles"></div>
      </div>

      <div class="hero__content">
        <p class="hero__kicker">北浦 RV PARK</p>
        <h1 class="hero__title">夕暮れの湖畔で、<br />時間がほどける。</h1>
        <p class="hero__lead">派手さではなく、余韻と静けさのための滞在体験。</p>
        <a class="hero__cta" href="#mock">空き状況を見る</a>
        <div class="hero__hint" aria-hidden="true">scroll</div>
      </div>
    </section>

    <!-- Phone canvas (9:16想定の見え方でスケール) -->
    <section class="section" id="mock" aria-label="モバイルUIモック">
      <div class="stage">
        <section class="phone" role="img" aria-label="RVパークLP（モバイルUIモック）">
          <!-- ホットスポット（透明ボタン） -->
          <a class="hotspot card card-1" href="#" aria-label="焚火を見る"></a>
          <a class="hotspot card card-2" href="#" aria-label="湖畔を見る"></a>
          <a class="hotspot card card-3" href="#" aria-label="星空を見る"></a>

          <a class="hotspot cta-mid" href="#" aria-label="この場所の魅力を見る"></a>
          <a class="hotspot cta-bottom" href="#" aria-label="空き状況を見る"></a>
        </section>
      </div>
    </section>
  </main>

  <!-- MVP: Lenis + GSAP（ScrollTrigger） -->
  <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/gsap.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/gsap@3.12.5/dist/ScrollTrigger.min.js"></script>
  <script src="https://unpkg.com/lenis/dist/lenis.min.js"></script>
  <script>
    (() => {
      const hero = document.querySelector(".hero");
      const cta = hero?.querySelector?.(".hero__cta") ?? null;
      const showCtaFallback = () => {
        if (!cta) return;
        cta.style.opacity = "1";
        cta.style.transform = "none";
      };

      const reduceMotion = window.matchMedia?.("(prefers-reduced-motion: reduce)")?.matches;
      if (reduceMotion) {
        showCtaFallback();
        return;
      }
      if (!window.gsap || !window.ScrollTrigger || !window.Lenis) {
        showCtaFallback();
        return;
      }

      gsap.registerPlugin(ScrollTrigger);

      // スクロールに「重さ」「呼吸」を与える（即時追従禁止）
      const lenis = new Lenis({
        lerp: 0.08,
        smoothWheel: true,
        wheelMultiplier: 0.9,
        syncTouch: true,
      });

      lenis.on("scroll", ScrollTrigger.update);
      gsap.ticker.add((time) => lenis.raf(time * 1000));
      gsap.ticker.lagSmoothing(0);

      if (!hero) return;

      const bg = hero.querySelector(".hero__bg");
      const haze = hero.querySelector(".hero__haze");
      const glow = hero.querySelector(".hero__glow");
      const particles = hero.querySelector(".hero__particles");

      // 初期状態（環境差でCSS transform を拾えない事故の回避）
      gsap.set(cta, { opacity: 0, y: 6 });

      // ピン留めで「静寂を一瞬溜める」：コピーは固定、背景だけがゆっくり動く
      const tl = gsap.timeline({
        scrollTrigger: {
          trigger: hero,
          start: "top top",
          end: "+=140%",
          scrub: 1.25, // ワンテンポ遅れる
          pin: true,
          anticipatePin: 1,
        },
      });

      tl.to(bg, { yPercent: -12, ease: "none" }, 0)
        .to(haze, { yPercent: -6, ease: "none" }, 0)
        .to(glow, { yPercent: -3, opacity: 0.95, ease: "none" }, 0)
        .to(particles, { opacity: 0.38, ease: "none" }, 0)
        // CTAは後半で“浮かび上がる”
        .to(cta, { opacity: 1, y: 0, ease: "none" }, 0.62);
    })();
  </script>
</body>
</html>

